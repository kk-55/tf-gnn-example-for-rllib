# tf-gnn-example-for-rllib
This repo shows an example how [TF-GNN](https://blog.tensorflow.org/2021/11/introducing-tensorflow-gnn.html) can be incorporated for graph (space) use cases in [RLlib](https://docs.ray.io/en/latest/rllib/index.html).

So far, there was no example/support for GNN models in [RLlib](https://docs.ray.io/en/latest/rllib/index.html). I've introduced a new [`Graph`](https://github.com/kk-55/tf-gnn-example-for-rllib/blob/c8d341213d08eaed59bb4f388cf46a4716441c92/tfgnn_rllib/utils/spaces/graph.py#L12) space (built upon [`Dict`](https://gymnasium.farama.org/api/spaces/composite/#dict) space) and added a simple [example](https://github.com/kk-55/tf-gnn-example-for-rllib/blob/main/tfgnn_rllib/examples/graph_space.py) which shows how to set up an [env](https://github.com/kk-55/tf-gnn-example-for-rllib/blob/main/tfgnn_rllib/examples/env/graph_obs_env.py) with an obs in form of a graph. This dict-like obs stores the current state of a graph and gets converted into a [`GraphTensor`](https://github.com/tensorflow/gnn/blob/main/tensorflow_gnn/docs/guide/graph_tensor.md#introduction-to-graphtensor) (a composite tensor introduced in [TF-GNN](https://blog.tensorflow.org/2021/11/introducing-tensorflow-gnn.html) library). This [`GraphTensor`](https://github.com/tensorflow/gnn/blob/main/tensorflow_gnn/docs/guide/graph_tensor.md#introduction-to-graphtensor) then is the input for a [custom GNN model](https://github.com/kk-55/tf-gnn-example-for-rllib/blob/main/tfgnn_rllib/examples/models/graph_obs_model.py) built with [TF-GNN](https://blog.tensorflow.org/2021/11/introducing-tensorflow-gnn.html). [TF-GNN](https://blog.tensorflow.org/2021/11/introducing-tensorflow-gnn.html) allows to build a wide variety of state-of-the-art GNNs, see [here](https://github.com/tensorflow/gnn/blob/main/tensorflow_gnn/docs/guide/gnn_modeling.md#tf-gnn-modeling-guide).\
The env and GNN model in my example are for illustration purposes only (no deeper sense). The point is just to show a way how someone can set up an environment with a graph-like observation and how (custom) GNN models can be created for such cases.\
More realistic examples might be small use cases of Shortest Path or Traveling Salesman Problem. I've started working on an example to train an agent with RLlib playing the [Shannon switching game](https://en.wikipedia.org/wiki/Shannon_switching_game) which is played by two players on a graph. I hope to add this example to the repo in the future.
